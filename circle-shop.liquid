{% schema %}
{
  "name": "Circle Shop",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Titre de la section",
      "default": "Shop By Category"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Couleur du fond",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "circle_spacing",
      "label": "Espacement entre cercles (px)",
      "min": 0,
      "max": 100,
      "step": 2,
      "default": 20
    },

    {
      "type": "header",
      "content": "Cercles"
    },
    {
      "type": "range",
      "id": "circle_size_desktop",
      "label": "Taille cercle desktop",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 150
    },
    {
      "type": "range",
      "id": "circle_size_tablet",
      "label": "Taille cercle tablette",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 130
    },
    {
      "type": "range",
      "id": "circle_size_mobile",
      "label": "Taille cercle mobile",
      "min": 50,
      "max": 250,
      "step": 10,
      "default": 100
    },

    {
      "type": "header",
      "content": "Icônes"
    },
    {
      "type": "range",
      "id": "icon_size_desktop",
      "label": "Taille icône desktop",
      "min": 8,
      "max": 80,
      "step": 1,
      "default": 30
    },
    {
      "type": "range",
      "id": "icon_size_tablet",
      "label": "Taille icône tablette",
      "min": 8,
      "max": 80,
      "step": 1,
      "default": 26
    },
    {
      "type": "range",
      "id": "icon_size_mobile",
      "label": "Taille icône mobile",
      "min": 6,
      "max": 60,
      "step": 1,
      "default": 20
    },
    {
      "type": "range",
      "id": "icon_offset_top",
      "label": "Décalage haut icône (px)",
      "min": -100,
      "max": 100,
      "step": 2,
      "default": 4
    },
    {
      "type": "range",
      "id": "icon_offset_left",
      "label": "Décalage gauche icône (px)",
      "min": -100,
      "max": 100,
      "step": 2,
      "default": 4
    },

    {
      "type": "header",
      "content": "Titre Section"
    },
    {
      "type": "range",
      "id": "title_size_desktop",
      "label": "Titre desktop",
      "min": 10,
      "max": 60,
      "default": 32
    },
    {
      "type": "range",
      "id": "title_size_tablet",
      "label": "Titre tablette",
      "min": 10,
      "max": 50,
      "default": 28
    },
    {
      "type": "range",
      "id": "title_size_mobile",
      "label": "Titre mobile",
      "min": 10,
      "max": 40,
      "default": 22
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Couleur du titre",
      "default": "#000000"
    },
    {
      "type": "checkbox",
      "id": "title_bold",
      "label": "Titre en gras",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Catégorie",
      "settings": [
        {
          "type": "image_picker",
          "id": "main_image",
          "label": "Image principale"
        },
        {
          "type": "image_picker",
          "id": "icon_image",
          "label": "Icône"
        },
        {
          "type": "text",
          "id": "circle_title",
          "label": "Titre du cercle",
          "default": "Jackets"
        },
        {
          "type": "url",
          "id": "collection_link",
          "label": "Lien de la collection"
        },
        {
          "type": "range",
          "id": "text_size_desktop",
          "label": "Texte desktop",
          "min": 10,
          "max": 40,
          "default": 16
        },
        {
          "type": "range",
          "id": "text_size_tablet",
          "label": "Texte tablette",
          "min": 10,
          "max": 35,
          "default": 14
        },
        {
          "type": "range",
          "id": "text_size_mobile",
          "label": "Texte mobile",
          "min": 10,
          "max": 30,
          "default": 12
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Couleur texte",
          "default": "#000000"
        },
        {
          "type": "checkbox",
          "id": "text_bold",
          "label": "Texte en gras",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Circle Shop",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<section class="shop-by-category" style="background-color: {{ section.settings.background_color }};">
  <div class="container">
    <h2 class="section-title"
      style="
        color: {{ section.settings.title_color }};
        font-weight: {% if section.settings.title_bold %}700{% else %}400{% endif %};
      ">
      {{ section.settings.section_title }}
    </h2>

    <div class="categories">
      {% for block in section.blocks %}
        <a href="{{ block.settings.collection_link }}" class="category-circle" style="margin: 0 {{ section.settings.circle_spacing | divided_by: 2 }}px;">
          <div class="circle-wrapper">
            {% if block.settings.main_image != blank %}
              <img src="{{ block.settings.main_image | img_url: '300x300' }}" alt="{{ block.settings.circle_title }}" class="main-img" />
            {% endif %}
            {% if block.settings.icon_image != blank %}
              <img src="{{ block.settings.icon_image | img_url: '100x100' }}" alt="icon" class="icon-img" />
            {% endif %}
          </div>
          <p class="circle-title"
            style="
              color: {{ block.settings.text_color }};
              font-weight: {% if block.settings.text_bold %}700{% else %}400{% endif %};
            ">
            {{ block.settings.circle_title }}
          </p>
        </a>
      {% endfor %}
    </div>
  </div>
</section>

<style>
.shop-by-category {
  padding: 40px 0;
  text-align: center;
}

.shop-by-category .section-title {
  margin-bottom: 40px;
}

.categories {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
}

.category-circle {
  text-decoration: none;
  text-align: center;
  display: inline-block;
  transition: transform 0.3s ease;
}
.category-circle:hover {
  transform: scale(1.05);
}

.circle-wrapper {
  position: relative;
  border-radius: 50%;
  overflow: visible; /* ✅ permet à l’icône de dépasser */
  border: 2px solid #e5e5e5;
  margin: 0 auto;
  transition: box-shadow 0.3s ease;
}
.category-circle:hover .circle-wrapper {
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.circle-wrapper .main-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

.circle-wrapper .icon-img {
  position: absolute;
  top: {{ section.settings.icon_offset_top }}px;
  left: {{ section.settings.icon_offset_left }}px;
}

/* Responsive circle + icon sizes */
@media (min-width: 1025px) {
  .circle-wrapper {
    width: {{ section.settings.circle_size_desktop }}px;
    height: {{ section.settings.circle_size_desktop }}px;
  }
  .shop-by-category .section-title {
    font-size: {{ section.settings.title_size_desktop }}px;
  }
  .circle-title {
    font-size: {{ block.settings.text_size_desktop }}px;
  }
  .circle-wrapper .icon-img {
    width: {{ section.settings.icon_size_desktop }}px;
    height: {{ section.settings.icon_size_desktop }}px;
  }
}
@media (max-width: 1024px) and (min-width: 768px) {
  .circle-wrapper {
    width: {{ section.settings.circle_size_tablet }}px;
    height: {{ section.settings.circle_size_tablet }}px;
  }
  .shop-by-category .section-title {
    font-size: {{ section.settings.title_size_tablet }}px;
  }
  .circle-title {
    font-size: {{ block.settings.text_size_tablet }}px;
  }
  .circle-wrapper .icon-img {
    width: {{ section.settings.icon_size_tablet }}px;
    height: {{ section.settings.icon_size_tablet }}px;
  }
}
@media (max-width: 767px) {
  .circle-wrapper {
    width: {{ section.settings.circle_size_mobile }}px;
    height: {{ section.settings.circle_size_mobile }}px;
  }
  .shop-by-category .section-title {
    font-size: {{ section.settings.title_size_mobile }}px;
  }
  .circle-title {
    font-size: {{ block.settings.text_size_mobile }}px;
  }
  .circle-wrapper .icon-img {
    width: {{ section.settings.icon_size_mobile }}px;
    height: {{ section.settings.icon_size_mobile }}px;
  }
}
</style>
