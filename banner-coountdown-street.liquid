<!-- stylesheet -->
<style>
  .streetwear-countdown {
    font-family: 'Bebas Neue', 'Oswald', sans-serif;
    padding: 20px;
    text-align: {{ section.settings.text_alignment }};
    background-color: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
    position: relative;
    overflow: hidden;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
  }
  
  .streetwear-countdown::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: repeating-linear-gradient(
      45deg,
      {{ section.settings.accent_color }},
      {{ section.settings.accent_color }} 10px,
      transparent 10px,
      transparent 20px
    );
  }
  
  .streetwear-countdown .container {
    max-width: 1200px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
  }
  
  .countdown-title {
    font-size: {{ section.settings.title_size }}px;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    font-weight: 700;
    color: {{ section.settings.title_color }};
    line-height: 1.2;
  }
  
  .countdown-subtitle {
    font-size: {{ section.settings.subtitle_size }}px;
    margin-bottom: 20px;
    font-weight: 400;
    color: {{ section.settings.subtitle_color }};
    line-height: 1.4;
  }
  
  .countdown-timer {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 25px;
  }
  
  .countdown-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 70px;
  }
  
  .countdown-value {
    font-size: {{ section.settings.timer_size }}px;
    font-weight: 700;
    background-color: {{ section.settings.accent_color }};
    color: #fff;
    padding: 8px 12px;
    border-radius: 4px;
    width: 100%;
    text-align: center;
    line-height: 1.2;
  }
  
  .countdown-label {
    font-size: 14px;
    margin-top: 5px;
    text-transform: uppercase;
    color: {{ section.settings.text_color }};
    opacity: 0.9;
  }
  
  .countdown-button {
    display: inline-block;
    padding: 12px 30px;
    background-color: {{ section.settings.button_color }};
    color: {{ section.settings.button_text_color }};
    text-decoration: none;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 1px;
    border: {{ section.settings.button_border_width }}px solid {{ section.settings.button_border_color }};
    border-radius: {{ section.settings.button_border_radius }}px;
    font-size: {{ section.settings.button_text_size }}px;
    transition: all 0.3s ease;
  }
  
  .countdown-button:hover {
    background-color: {{ section.settings.button_hover_color }};
    color: {{ section.settings.button_hover_text_color }};
    border-color: {{ section.settings.button_hover_border_color }};
    transform: translateY(-2px);
  }
  
  .countdown-expired {
    font-size: {{ section.settings.timer_size }}px;
    font-weight: 700;
    text-transform: uppercase;
    color: {{ section.settings.accent_color }};
    margin: 20px 0;
  }
  
  @media (max-width: 768px) {
    .countdown-timer {
      gap: 8px;
    }
    
    .countdown-item {
      min-width: 60px;
    }
    
    .countdown-value {
      font-size: {{ section.settings.timer_size | times: 0.8 }}px;
      padding: 6px 8px;
    }
    
    .countdown-title {
      font-size: {{ section.settings.title_size | times: 0.8 }}px;
    }
    
    .countdown-subtitle {
      font-size: {{ section.settings.subtitle_size | times: 0.8 }}px;
    }
    
    .streetwear-countdown {
      padding: 15px;
    }
  }
</style>

<!-- html -->
<section class="streetwear-countdown">
  <div class="container">
    <h2 class="countdown-title">{{ section.settings.title }}</h2>
    <p class="countdown-subtitle">{{ section.settings.subtitle }}</p>
    
    <div class="countdown-timer" data-end-date="{{ section.settings.end_date }}">
      <div class="countdown-item">
        <span class="countdown-value" id="days">00</span>
        <span class="countdown-label">Jours</span>
      </div>
      <div class="countdown-item">
        <span class="countdown-value" id="hours">00</span>
        <span class="countdown-label">Heures</span>
      </div>
      <div class="countdown-item">
        <span class="countdown-value" id="minutes">00</span>
        <span class="countdown-label">Mins</span>
      </div>
      <div class="countdown-item">
        <span class="countdown-value" id="seconds">00</span>
        <span class="countdown-label">Secs</span>
      </div>
    </div>
    
    <p id="countdown-expired" class="countdown-expired" style="display: none;">La promotion est terminée!</p>
    
    <a href="{{ section.settings.button_link }}" class="countdown-button">{{ section.settings.button_text }}</a>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  function updateCountdown() {
    const countdownElements = document.querySelectorAll('.countdown-timer[data-countdown]');
    
    countdownElements.forEach(function(countdownTimer) {
      const countdownDate = new Date(countdownTimer.dataset.countdown).getTime();
      const expiredMessage = document.getElementById('countdown-expired');
      
      if (!countdownDate || isNaN(countdownDate)) {
        console.error('Date de fin invalide:', countdownTimer.dataset.countdown);
        if (expiredMessage) {
          expiredMessage.style.display = 'block';
          countdownTimer.style.display = 'none';
        }
        return;
      }
      
      const now = new Date().getTime();
      const distance = countdownDate - now;
      
      if (distance < 0) {
        if (expiredMessage) {
          expiredMessage.style.display = 'block';
          countdownTimer.style.display = 'none';
        }
        return;
      } else {
        if (expiredMessage) {
          expiredMessage.style.display = 'none';
          countdownTimer.style.display = 'flex';
        }
      }
      
      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);
      
      const daysEl = document.getElementById('days');
      const hoursEl = document.getElementById('hours');
      const minutesEl = document.getElementById('minutes');
      const secondsEl = document.getElementById('seconds');
      
      if (daysEl) daysEl.textContent = days.toString().padStart(2, '0');
      if (hoursEl) hoursEl.textContent = hours.toString().padStart(2, '0');
      if (minutesEl) minutesEl.textContent = minutes.toString().padStart(2, '0');
      if (secondsEl) secondsEl.textContent = seconds.toString().padStart(2, '0');
    });
  }
  
  updateCountdown();
  setInterval(updateCountdown, 1000);
});
</script>

{% schema %}
{
  "name": "Streetwear Countdown",
  "settings": [
    {
      "type": "header",
      "content": "Textes"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Titre",
      "default": "PROMO EXCEPTIONNELLE"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Sous-titre",
      "default": "Soldes de fin de saison - Jusqu'à -50% sur toute la collection"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Alignement du texte",
      "options": [
        {
          "value": "left",
          "label": "Gauche"
        },
        {
          "value": "center",
          "label": "Centre"
        },
        {
          "value": "right",
          "label": "Droite"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Couleurs"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Couleur de fond",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Couleur de la bordure",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Couleur du texte",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Couleur du titre",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Couleur du sous-titre",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Couleur d'accent",
      "default": "#ff3366"
    },
    {
      "type": "header",
      "content": "Tailles de texte"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Taille du titre",
      "min": 16,
      "max": 60,
      "step": 1,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "subtitle_size",
      "label": "Taille du sous-titre",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "timer_size",
      "label": "Taille du compteur",
      "min": 16,
      "max": 50,
      "step": 1,
      "default": 28,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Bordures"
    },
    {
      "type": "range",
      "id": "border_width",
      "label": "Épaisseur de la bordure",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 2,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Bouton"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texte du bouton",
      "default": "SHOP MAINTENANT"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Lien du bouton"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Couleur du bouton",
      "default": "#ff3366"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Couleur du texte du bouton",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Couleur de la bordure",
      "default": "#ff3366"
    },
    {
      "type": "range",
      "id": "button_border_width",
      "label": "Épaisseur de la bordure",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "label": "Rayon des coins",
      "min": 0,
      "max": 50,
      "step": 1,
      "default": 4,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "button_text_size",
      "label": "Taille du texte du bouton",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Couleur au survol",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Couleur du texte au survol",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_border_color",
      "label": "Couleur de la bordure au survol",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Paramètres du compte à rebours"
    },
    {
      "type": "text",
      "id": "end_date",
      "label": "Date de fin (format: YYYY-MM-DDTHH:MM:SS)",
      "default": "2025-10-15T23:59:59",
      "info": "Format: AAAA-MM-JJTHH:MM:SS (ex: 2025-10-15T23:59:59)"
    }
  ],
  "presets": [
    {
      "name": "Streetwear Countdown",
      "category": "Promotional"
    }
  ]
}
{% endschema %}